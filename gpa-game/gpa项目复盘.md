# **项目复盘**

- ### 项目摘要

  - 此次项目面向学校16~19级的学生，从南大家园app中拿token，向用户展示入学年份，经历学期，课时，绩点等一系列数据，最后通过用电量，成绩，学生等级拿到各自的人设图，最后随机展示其中一张，基本功能差不多就是这样。

- ### 项目过程

  - 首页部分

    - 本来是任意点击滑到底部会有一个平滑到底部的动画，我就用了`element.scrollIntoView({behavior: "smooth", block: "end"});`，

      但是浏览器兼容性差，就弃用了。

  - 显示纸条部分

    - 进去会有一个扭蛋机画面，是一张13M大的gif，用户体验太差了，之后经过一系列的优化，到5M也算还行，因为要控制gif的播放和暂停，但是找了很多js库都没找到我想要的，最后只能曲线救国，暂停就用静态图替代，然后播放就显示gif (gif设定播放一次就停止，不循环)，但是怎么让他重新播放呢？不是点击一次就静止了嘛？因为项目需要多次扭蛋，所以是要多次播放的。然后还是邪教方法是`element.src = element.src  ` ，这样就重新渲染了，既可以实现扭蛋效果，又不用重新加载gif这样大的文件。
    - 纸条数据的存储是我觉得我做的最差的部分，也因此导致项目后期bug连连，因为图快(想赶紧做完然后开心的玩耍哈哈哈)，所有我把所有的数据存在了一个数组当中，将每张纸条的数据，背景颜色，背景图片等全放在了一个对象中，前期尽管静态数据显示的还不错，但是后面真正测试起来，因为要对数据进行判断，首先要判断数据是否为空，不然会出现渲染错误，然后还有各种渲染逻辑，导致显示成绩这一栏我需要在jsx中嵌套7~8层三目运算符，最终因为脑子转不过来，没有进行判断，所以成绩低的同学也会显示比较尬的文案，这个是我的锅。
    - 因为纸条数据需要token，所以要从app中拿token，是在deadline的前一天找孙桑进行测试的，我对app的了解知道的太少了，做到项目才知道有incu-webview这个库，拿token的过程一波三折，甚是坎坷，我和孙桑两个人一晚上才将其拿到(主要是因为我代码写的太屎了)，之后还会发生一件神奇的事。中途孙桑还编译了一个测试版本的app给我用。感谢！

  - 显示人设部分

    - 人设部分算是比较简单的，只要对之前拿到的数据进行一个基本的判断就可以完成，但是要我在小小的拼图上，写上几个小字，我只能说臣妾做不到啊===，我太菜了，然后就随机显示在页面上。最后一测过后，还是换了显示人设方式，但是有很多图，要求显示符合的人设图中的一张，就random了一下。

  - 结尾部分

    - 和首页的逻辑差不多，于是很快就完成了，就是我用的大量dom，哈哈哈真是惨不忍睹，当然，能用就行。

  - loading部分

    - loading部分绝对是这次项目中最值得去说道的部分之一，做了很多天，我只能说，太难了，我用了suspense和react-loadable，但是效果我觉得还是不行，我想要的是页面资源加载完毕后再显示，因为没有字体就显得格外难看，最后用了load事件，等资源加载完毕再显示页面，当然，loading和页面都通过visibility来隐藏和显示，有点傻逼，但是我发现load事件只会执行一次，于是我在每个路由页面都加了一个reload一次来执行load事件，结果因为ios端刷新会把localstorage清除，因为token存在上面，所以在第一次测试时，我把它换成了setTimeout，当然很多人会因为这个白屏，因为在setTimeout之后没有加载完成，就会出现拿不到dom的结果，而且gif如果不加载完成就会非常卡顿，动画及其不流畅，导致用户体验非常差。所以在第二次我改用了`element.complete`  来判断gif是否加载完成，虽然加载时间久一点，但是动画会流畅很多，也避免了localstorage丢失，算是比较人性化完成了。

  - 部署部分

    - 因为不清楚家园的部署流程，而且时间紧急，就找了彬彬，然后彬彬一顿猛如虎的操作直接让我想喊666，oss+cdn部署，还有node的部署脚本，真的太方便了，等我有时间去看看代码。

  - 交互部分

    - emm不谈，基本没有交互和提示，这是这个项目最烂的地方，也是我最讨厌的地方，因为时间紧，而且我刚考完脑子不太好使，也出去玩了几天，就忘记了，后来就一直拖着没做，导致交互性非常差。

- ### 总结

  - 这是我第一次写这样总结性的东西，可能写的不是很好，我承认，这是我在家园最不用心的一次项目，我想了一下原因，期末考试，加放假期间。我失去了热情，因为我自己的性格缺陷，有任务在身上，我就很难专心，考之前，其实项目已经开始了，但是设计图没有出完，要拖到期末期间出完，而这时，我期末复习的还不行，所以我就申请延后到了15号，我考完之后，没有迟缓，就一直在写，但是设计图还是没有出完，我就还是没办法做，可能是因为我不擅长沟通的问题，导致我不知道到底想设计成啥样，我看了产品的原型图，陷入了思考。。我也13号封校才回的家，期间一直在写，因为我之前写的垃圾代码太多了，之前想的是老八名言，不管是腥还是臭，到了嘴里都是肉，所以只能花更多时间去垃圾回收，早知道这样就不为了赶进度乱写了，尽管我花了很多时间写，但是这些天我没有放松，基本除了正常的生理需求之外都在写，尽管完成的很差，但是我的的确确花了很长时间，对它说句对不起吧。还有埋点我也没做，目光还是太短浅了些。写代码的能力也变差了不少，可能对框架理解，还有js的异步等理解的不够深入，寒假一定再好好学学，有机会重构一下，继续加油吧，奥里给！。

- 